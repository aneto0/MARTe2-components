+DMATypes = {

    Class = ReferenceContainer

    +PacketDelimiter64Type = {              
        Class = IntrospectionStructure          
        PacketCounter = {                       
            Type = uint8                        
        }
        Markers = {                     
            Type = uint8                        
            NumberOfElements = 7                
        }
    }

    +DMA_T2H_PacketType = {
        Class = IntrospectionStructure
        LeadDelimiter = {                       
            Type = PacketDelimiter64Type                        
        }
        EventsStatus = {                
            Type = uint64       
        }
        CG0ActionStatus = {             
            Type = uint32       
        }
        CG1ActionStatus = {             
            Type = uint32       
        }
        CG0IOP = {          
            Type = uint16       
        }
        CG1IOP = {              
            Type = uint16       
        }
        IOP = {         
            Type = uint16
        }
        OPSTATE = {             
            Type = uint16
        }
        TKlocked = {            
            Type = uint16
        }
        TKfsm = {               
            Type = uint16
        }
        TKcorrection_period_cc = {              
            Type = uint32       
        }
        TKtime = {              
            Type = uint64
        }
        TKclock_cycles_since_last_sync = {              
            Type = uint64
        }
        Empty = {
            Type = uint64
            NumberOfElements = 16
        }
        TrailDelimiter = {      
            Type = PacketDelimiter64Type        
        }

    }

}



+Test = {
    Class = RealTimeApplication
    +Functions = {
        Class = ReferenceContainer
        +One = {
            Class = IOGAM
            InputSignals = {
                Counter = {
                    Type = uint64
                    DataSource = Timer
                    Frequency = 2000
                }

            }
            OutputSignals = {
                Counter = {
                    Type = uint64
                    DataSource = DDB1
                }
            }
        }
        +Two = {
            Class = IOGAM
            InputSignals = {
                Counter = {
                    Type = uint64
                    DataSource = DDB1
                }

            }
            OutputSignals = {
                Counter = {
                    Alias=Other.EventsStatus
                    Type = uint64
                    DataSource = DDB1
                }
            }
        }        
        +Sync = {
            Class = IOGAM
            InputSignals = {
                Other = {
                    Type = DMA_T2H_PacketType
                    DataSource = DDB1
                }
                Dummy = {
                    Type = uint64
                    DataSource = DDB1
                }                
                Counter1 = {
                    Alias = Counter
                    Type = uint64
                    DataSource = DDB1
                }
            }
            OutputSignals = {
                Other = {
                    Type = DMA_T2H_PacketType
                    DataSource = ThreadASync
                }
                Dummy = {
                    Type = uint64
                    DataSource = ThreadSync
                    Trigger = 1
                }
                Counter1 = {
                    Type = uint64
                    DataSource = DDB1
                }
            }
        }
        +Synced = {
            Class = IOGAM
            InputSignals = {
                Dummy = {
                    Type = uint64
                    DataSource = ThreadSync
                    Samples = 1
                    Frequency = 1000
                }
                Other = {
                    Type = DMA_T2H_PacketType
                    DataSource = ThreadASync
                }                
            }
            OutputSignals = {
                Dummy2 = {
                    Type = uint64
                    DataSource = DDB1
                }
                Other2 = {
                    Type = DMA_T2H_PacketType
                    DataSource = DDB1
                }                
            }
        }
        +CurrentTime = {
            Class = IOExt::SystemClockGAM
            OutputSignals = {
                CurrTime = { 
                    DataSource = DDB1
                    Type = uint64
                }
            }
        }       
        +ComputeSleep = {
            Class = IOExt::MathExpressionExprtkGAM
            InputSignals = {
                CurrTime = { 
                    DataSource = DDB1
                    Type = uint64
                }            
            }
            OutputSignals = {
                SleepUntil = { 
                    DataSource = DDB1
                    Type = uint64
                    Expression = "SleepUntil := CurrTime+1100000"
                }            
            }
        }         
        +Sleep = {
            Class = IOExt::WaitUntilGAM
            InputSignals = {
                 SleepUntil = {
                     Type = uint64
                     DataSource = DDB1
                 }                 
            }
            OutputSignals = {
                 SleepUntilFb = {
                     Type = uint64
                     DataSource = DDB1
                 }                 
            }
        }        
    }
    +Data = {
        Class = ReferenceContainer
        DefaultDataSource = DDB1
        +Timings = {
            Class = TimingDataSource
        }
        +DDB1 = {
            Class = GAMDataSource
            AllowNoProducers = 1
        }
        +Logger = {
            Class = LoggerDataSource
        }
        +Timer = {
            Class = LinuxTimer
            SleepNature = "Busy"
            SleepPercentage = 70
            ExecutionMode = "RealTimeThread"
            +TcnTimeProvider = {
                Class = IOExt::SystemClockTimeProvider
            }            
            Signals = {
                Counter = {
                    Type = uint32
                }
                Time = {
                    Type = uint32
                }
                AbsTime = {
                    Type = uint64
                }
                DeltaTime = {
                    Type = uint64
                }                   
            }
        }
        +ThreadSync = {
            Class = RealTimeThreadSynchronisation       
            Timeout = 1000
        }
        +ThreadASync = {
            Class = RealTimeThreadAsyncBridge
            NumberOfBuffers = 3
        }
        
        
    }
    +States = {
        Class = ReferenceContainer
        +Idle = {
            Class = RealTimeState
            +Threads = {
                Class = ReferenceContainer
                +Thread1 = {
                    Class = RealTimeThread
                    CPUs = 0x4
                    Functions = { One Two Sync }
                }
                +Thread2 = {
                    Class = RealTimeThread
                    CPUs = 0x4
                    Functions = { Synced CurrentTime ComputeSleep Sleep }
                    //Functions = { Synced }
                }                
            }
        }
    }
    +Scheduler = {
        Class = GAMScheduler
        TimingDataSource = Timings
    }
}
